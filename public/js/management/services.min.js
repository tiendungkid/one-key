let[processing,liveSearchCurrent]=[!1,""];const[serviceDetailModal,serviceDetailClose,serviceDetailSaveButton,serviceDetailSaveText,serviceDetailSaving,serviceDetailDelete,serviceDetailTag]=[$(`#service-detail-modal`),$(`#service-detail-close`),$(`#service-detail-save`),$(`#service-detail-save-text`),$(`#service-detail-saving`),$(`#service-detail-delete`),$(`#service-detail-link`)],[serviceDetailId,serviceDetailMainName,serviceDetailName,serviceDetailHomeLink,serviceDetailLogoLink,serviceDetailDescription,serviceDetailImage]=[$(`#service-detail-id`),$(`#service-detail-main-name`),$(`#service-detail-name`),$(`#service-detail-home-link`),$(`#service-detail-logo-link`),$(`#service-detail-description`),$(`#service-detail-img`)],[serviceDetailDeleteCard,serviceDetailConfirm]=[$(`#service-detail-delete-card`),$(`#service-detail-confirm`)],[addServiceModal,closeModalButton]=[$(`#add-service-modal`),$(`#add-service-close`)],[inputServiceName,inputServiceHome,inputServiceLogo,inputServiceDescription]=[$(`#add-service-name`),$(`#add-service-home-link`),$(`#add-service-logo-link`),$(`#add-service-description`)],[saveNewServiceButton,saveNewServiceButtonText,saveNewServiceSaving]=[$(`#add-service-save`),$(`#add-service-save-text`),$(`#add-service-saving`)],[storeServiceLink,searchServiceLink,findServiceLink,updateServiceLink,deleteServiceLink,serviceDetailLink]=[$(`meta[name=store-link]`).attr("content"),$(`meta[name=live-search-service-link]`).attr("content"),$(`meta[name=find-service-link]`).attr("content"),$(`meta[name=update-service-link]`).attr("content"),$(`meta[name=delete-service-link]`).attr("content"),$(`meta[name=service-detail-link]`).attr("content").replace("0","")],[searchBox,serviceList,placeholderService]=[$(`#search-service`),$(`#service-list`),$(`#service-info-placeholder`)],delay=(a,b)=>{var c=0;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b||0)}},visibilitySavingService=(a=!1)=>{a?([inputServiceName,inputServiceHome,inputServiceLogo,inputServiceDescription].forEach(a=>a.prop("disabled",!0)),saveNewServiceButtonText.addClass("d-none"),saveNewServiceSaving.removeClass("d-none"),[serviceDetailName,serviceDetailHomeLink,serviceDetailLogoLink,serviceDetailDescription].forEach(a=>a.prop("disabled",!0)),serviceDetailSaveText.addClass("d-none"),serviceDetailSaving.removeClass("d-none")):([inputServiceName,inputServiceHome,inputServiceLogo,inputServiceDescription].forEach(a=>a.prop("disabled",!1)),saveNewServiceButtonText.removeClass("d-none"),saveNewServiceSaving.addClass("d-none"),[serviceDetailName,serviceDetailHomeLink,serviceDetailLogoLink,serviceDetailDescription].forEach(a=>a.prop("disabled",!1)),serviceDetailSaving.addClass("d-none"),serviceDetailSaveText.removeClass("d-none"))},serviceCardGenerator=(a=[])=>{serviceList.empty(),serviceList.append(a.map(a=>`<div class="service-card col-xl-3 col-lg-4 col-sm-6" data-id="${a.hashId}"><div class="service-inner"><div class="service-logo">${a.name.charAt(0).toUpperCase()}${a.name.substring(1,a.name.length)}</div><div class="service-info"><div class="row"><div class="col-md-12"><div class="service-count"><div class="count">${a.accounts_count}</div></div><a href="${a.home_link}">${a.home_link}</a></div></div></div></div></div>`))},liveSearchService=(a="")=>{processing||(liveSearchCurrent=a,visibleSearching(!0),$.ajax(searchServiceLink,{dataType:"json",data:{query:a},success:function(a){a.status&&serviceCardGenerator(a.data)},complete:()=>{setTimeout(function(){visibleSearching(!1)},1e3)}}))},serviceDetailGenerator=a=>{serviceDetailId.val(a.hashId),serviceDetailName.val(a.name),serviceDetailHomeLink.val(a.home_link),serviceDetailLogoLink.val(a.logo_link),serviceDetailDescription.val(a.description),serviceDetailDeleteCard.addClass("d-none"),serviceDetailConfirm.val(""),serviceDetailConfirm.prop("disabled",!1),serviceDetailTag.attr("href",`${serviceDetailLink}${a.hashId}`),a.home_link?serviceDetailMainName.html(`<a href="${a.home_link.includes("http")?a.home_link:"//"+a.home_link}" target="_blank">${a.name}</a>`):serviceDetailMainName.text(a.name),a.logo_link?serviceDetailImage.attr("src",a.logo_link).removeClass("d-none"):serviceDetailImage.addClass("d-none"),serviceDetailDelete.html(`<i class="fas fa-trash"></i>`),serviceDetailModal.modal("show")},deleteService=()=>{processing||(processing=!0,$.ajax(deleteServiceLink,{method:"post",dataType:"json",data:{id:serviceDetailId.val()},success:a=>{a.status?notifyAdmin("success","Deleted service !"):notifyAdmin("danger","Delete service failed !")},complete:()=>{processing=!1,liveSearchService(),serviceDetailClose.trigger("click")}}))},visibleSearching=(a=!1)=>{a?(serviceList.hide(),placeholderService.removeClass("d-none")):(placeholderService.addClass("d-none"),serviceList.fadeIn())};closeModalButton.on("click",()=>{addServiceModal.modal("hide")}),serviceDetailClose.on("click",()=>{serviceDetailModal.children().removeClass("animate__backInUp").addClass("animate__bounceOutDown"),setTimeout(()=>{serviceDetailModal.modal("hide"),serviceDetailModal.children().removeClass("animate__bounceOutDown").addClass("animate__backInUp")},500)}),saveNewServiceButton.on("click",()=>{if(!processing){processing=!0,visibilitySavingService(!0);let[a,b,c,d]=[inputServiceName,inputServiceHome,inputServiceLogo,inputServiceDescription].map(a=>a.val());$.ajax(storeServiceLink,{method:"post",dataType:"json",data:{name:a,home_link:b,logo_link:c,description:d},success:a=>{a.status?notifyAdmin("success","Add new service successfully !"):notifyAdmin("danger","Add new service failed !")},complete:()=>{processing=!1,visibilitySavingService(),closeModalButton.trigger("click"),liveSearchService()}})}}),serviceDetailSaveButton.on("click",()=>{if(!processing){processing=!0,visibilitySavingService(!0);let[a,b,c,d,e]=[serviceDetailId,serviceDetailName,serviceDetailHomeLink,serviceDetailLogoLink,serviceDetailDescription].map(a=>a.val());$.ajax(updateServiceLink,{method:"post",dataType:"json",data:{id:a,name:b,home_link:c,logo_link:d,description:e},success:a=>{a.status?notifyAdmin("success","Update service successfully !"):notifyAdmin("danger","Update service failed !")},complete:()=>{processing=!1,visibilitySavingService(),serviceDetailClose.trigger("click"),liveSearchService()}})}}),searchBox.keyup(delay(function(){let a=$(this).val();a!==liveSearchCurrent&&(liveSearchCurrent=a,0!==a?.length&&liveSearchService(a))},500)),serviceDetailDelete.on("click",()=>{serviceDetailDeleteCard.hasClass("d-none")?serviceDetailDeleteCard.removeClass("d-none"):serviceDetailConfirm.val()===serviceDetailMainName.text().toLowerCase()?(serviceDetailConfirm.removeClass("text-red"),serviceDetailConfirm.prop("disabled",!0),serviceDetailDelete.text("Deleting..."),deleteService()):serviceDetailConfirm.addClass("text-red")}),$(document).on("click",".service-card",function(a){if(a.preventDefault(),!processing){processing=!0;let a=$(this),b=$(this).attr("data-id");a.children().children().first().addClass("animate__animated animate__infinite animate__flash text-danger"),$.ajax(findServiceLink,{dataType:"json",data:{id:b},success:a=>{a.status?serviceDetailGenerator(a.data):notifyAdmin("warning","Get service detail failed, Please try again !")},error:()=>{notifyAdmin("danger","Get service detail failed, Please try again !")},complete:function(){processing=!1,a.children().children().first().removeClass("animate__animated animate__infinite animate__flash text-danger")}})}});